<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="egovframework.com.project.mapper.ProjectMapper">

	<!-- 등록 -->
	<insert id="projectInsert" parameterType="projectDTO">
		INSERT INTO project (
			pr_cd,
			type_cd,
			pr_nm,
			ahead_dt,
			start_dt,
			end_dt,
			price,
			create_id,
			entrprs_mber_id,
			del_yn
		)
		VALUES (
			seq_pr_cd.nextval,
			#{typeCd},
			#{prNm},
			#{aheadDt},
			#{startDt},
			#{endDt},
			#{price},
			#{createId},
			#{entrprsMberId},
			#{delYn}
		)
		
	</insert>
	
	<!-- 수정 -->
	<update id="projectUpdate" parameterType="projectDTO">
		update project
		set	
			<if test="typeCd != null and !typeCd.equals('')">
			type_cd = #{typeCd}, 
			</if>
			<if test="prNm != null and !prNm.equals('')">
			pr_nm = #{prNm},
			</if>
			ahead_dt = #{aheadDt},
			<if test="(startDt != null and !startDt.equals('')) and endDt != null and !endDt.equals(''))">
			start_dt = #{startDt},
			end_dt = #{endDt},
			</if>
			price = #{price},
			update_id = #{updateId},
			update_dt = sysdate,
			del_yn = #{delYn}
		where pr_cd = ${prCd}				
	</update>
	
	<!-- 삭제 -->
	<update id="projectDelete" parameterType="String">
		UPDATE 
		   project
		SET
		   del_yn = UPPER('Y')
		WHERE
		   pr_cd = ${prCd}	
	</update>
	
	<!-- 단건조회 -->
	<select id="projectSelect" parameterType="String">
		select pr_cd,
			   fn_get_codename(type_cd) as ACT_TYPE,
			   pr_nm,
			   ahead_dt,
			   start_dt,
			   end_dt,
			   price,
			   create_id,
			   create_dt,
			   entrprs_mber_id,
			   del_yn
		from project
		where pr_cd = #{prCd} and del_yn='N'
	</select>
	
	<!-- 전체조회 -->
	<select id="projectSelectAll" parameterType="int" resultType="projectDTO">
		select pr_cd,
			   fn_get_codename(type_cd) as ACT_TYPE,
			   pr_nm,
			   ahead_dt,
			   start_dt,
			   end_dt,
			   price,
			   create_id,
			   create_dt,
			   entrprs_mber_id,
			   del_yn
		from project
		where del_yn='N'
		order by create_dt desc
	</select>

</mapper>